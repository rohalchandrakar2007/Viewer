{"version":3,"sources":["config.js","envConfig.js","Utils.js","AjaxUtil.js","ViewUtil.js","CameraUtil.js","ModelService.js","ControllerMode.js","SceneModel.js","SceneView.js","SceneController.js","Event.js","init.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["var Config = (function () {\n    var Config = {\n        urlAppName: '/pixum-model-viewer',\n        errorMsgClass: 'error-msg',\n\n    };\n    return Config;\n})();\n","var EnvConfig = (function () {\n    var env;\n\n    switch (window.location.hostname) {\n        case 'oobi.proptiger-ws.com':\n            env = 'beta';\n            break;\n        case 'oobi.proptiger.com':\n            env = 'prod';\n            break;\n        default:\n            env = 'dev';\n            break;\n\n    }\n\n    var EnvConfig = {\n        dev: {\n            env: env,\n            protocol: 'http://',\n            apiURL: 'localhost:8888',\n            showLogs: true\n        },\n        beta: {\n            env: env,\n            protocol: window.location.protocol + '//',\n            apiURL: '',\n            showLogs: true\n        },\n        prod: {\n            env: env,\n            protocol: window.location.protocol + '//',\n            apiURL: '',\n            showLogs: false\n        }\n    };\n\n    return EnvConfig[env];\n\n})();\n","\"use strict\";\n\nvar Util = (function(){\n    return {\n        // \n    };\n})();","\"use strict\";\n\nvar AjaxUtil = (function () {\n    return {\n        getData: function (url) {\n            var self = this;\n            var ajaxObj = {\n                type: \"GET\",\n                url: url,\n                async: true,\n                dataType: \"json\",\n                success: function (data) {\n                    // register success callback in return promise\n                },\n                error: function (jqXHR, textStatus, errorThrown) {}\n            };\n\n            return $.ajax(ajaxObj);\n        },\n        getObjMtlFileData: function (__rootPath, __objFileName, __mtlFileName, params) {\n            var self = this;\n            //var progressCallback = params.progressCallback || false;\n\n            var onLoad = params.onLoad || function defaultOnloadCallback() {\n\n            };\n            var onError = params.onError || function defaultErrorCallback() {\n\n            };\n            var onProgress = params.onProgress || function (xhr) {\n                if (xhr.lengthComputable) {\n                    var percentComplete = xhr.loaded / xhr.total * 100;\n                    console.log(Math.round(percentComplete, 2) + '% downloaded');\n                }\n            }\n\n            var manager = new THREE.LoadingManager();\n            manager.onProgress = function (item, loaded, total) {\n                console.log(item, loaded, total);\n            };\n\n            var mtlLoader = new THREE.MTLLoader();\n            mtlLoader.setPath(__rootPath);\n            mtlLoader.load(__mtlFileName,\n                function (mat) {\n                    var loader = new THREE.OBJLoader(manager);\n                    loader.setMaterials(mat);\n                    loader.setPath(__rootPath);\n                    loader.load(__objFileName,\n                        onLoad,\n                        onProgress,\n                        onError\n                    );\n                }\n            );\n        },\n        getObjFileData: function (__rootPath, __objFileName, params) {\n            var self = this;\n            //var progressCallback = params.progressCallback || false;\n\n            var onLoad = params.onLoad || function defaultOnloadCallback() {\n\n            };\n            var onError = params.onError || function defaultErrorCallback() {\n\n            };\n            var onProgress = params.onProgress || function (xhr) {\n                if (xhr.lengthComputable) {\n                    var percentComplete = xhr.loaded / xhr.total * 100;\n                    console.log(Math.round(percentComplete, 2) + '% downloaded');\n                }\n            }\n\n            var manager = new THREE.LoadingManager();\n            manager.onProgress = function (item, loaded, total) {\n                console.log(item, loaded, total);\n            };\n\n            var loader = new THREE.OBJLoader(manager);\n            loader.setPath(__rootPath);\n            loader.load(__objFileName,\n                onLoad,\n                onProgress,\n                onError\n            );\n        },\n        getFbxFileData: function (__filePath, params) {\n            var self = this;\n            //var progressCallback = params.progressCallback || false;\n\n            var onLoad = params.onLoad || function defaultOnloadCallback() {\n\n            };\n            var onError = params.onError || function defaultErrorCallback() {\n\n            };\n            var onProgress = params.onProgress || function (xhr) {\n                if (xhr.lengthComputable) {\n                    var percentComplete = xhr.loaded / xhr.total * 100;\n                    console.log(Math.round(percentComplete, 2) + '% downloaded');\n                }\n            }\n\n            var manager = new THREE.LoadingManager();\n            manager.onProgress = function (item, loaded, total) {\n                console.log(item, loaded, total);\n            };\n\n            var loader = new THREE.FBXLoader(manager);\n            loader.load(__filePath,\n                onLoad,\n                onProgress,\n                onError\n            );\n        },\n        getColladaFileData: function (__filePath, params) {\n            var self = this;\n            //var progressCallback = params.progressCallback || false;\n\n            var onLoad = params.onLoad || function defaultOnloadCallback() {\n\n            };\n            var onError = params.onError || function defaultErrorCallback() {\n\n            };\n            var onProgress = params.onProgress || function (xhr) {\n                if (xhr.lengthComputable) {\n                    var percentComplete = xhr.loaded / xhr.total * 100;\n                    console.log(Math.round(percentComplete, 2) + '% downloaded');\n                }\n            }\n\n            var manager = new THREE.LoadingManager();\n            manager.onProgress = function (item, loaded, total) {\n                console.log(item, loaded, total);\n            };\n\n            var loader = new THREE.ColladaLoader(manager);\n            loader.options.convertUpAxis = true;\n            loader.load(__filePath,\n                onLoad,\n                onProgress,\n                onError\n            );\n        },\n        makeRequest: function (url, type, data, async) {\n            var enableCORS = enableCORS || false;\n            var data = (typeof data === 'undefined') ? {} : data;\n\n            var ajaxObj = {\n                type: type,\n                url: url,\n                async: true,\n                dataType: \"json\",\n                data: JSON.stringify(data),\n                contentType: \"application/json\",\n                success: function (data) {\n                    // register success callback in return promise\n                },\n                error: function (jqXHR, textStatus, errorThrown) {\n                    utils.log('read error callback for: ' + url);\n                    utils.log('error occured ' + errorThrown);\n                    return false;\n                }\n            };\n\n            return $.ajax(ajaxObj);\n        },\n        getJsonData: function (url, callback) {\n            var self = this;\n            return $.ajax({\n                type: 'GET',\n                url: url,\n                async: true,\n                jsonpCallback: callback,\n                contentType: \"application/json\",\n                dataType: \"jsonp\",\n                success: function (data) {\n                    // register success callback in return promise\n                },\n                error: function (jqXHR, textStatus, errorThrown) {\n                    utils.log('read json error callback for: ' + url);\n                    utils.log('error occured ' + errorThrown);\n                    self.handleAjaxErrorDefaultCallback(jqXHR, textStatus, errorThrown);\n                }\n            });\n        }\n    };\n})();\n","\"use strict\";\n\nvar ViewUtil = (function () {\n    return {\n        showModal: function (msg) {\n            alert(msg);\n        },\n        showLoader: function () {\n            var template = [];\n\n            template.push(\n                '<div id=\"loader213DSDdsdASD3dds\" style=\"position:absolute;top:0;right:0;bottom:0;left:0;\">',\n                'Loading...',\n                '</div>'\n            );\n            template = template.join('');\n\n            $(document.body).append(template);\n        },\n        hideLoader: function () {\n            $('#loader213DSDdsdASD3dds').remove();\n        },\n        getWebVRSettings: function () {\n            return {\n                /**\n                 * webvr-polyfill configuration\n                 */\n                // Forces availability of VR mode.\n                FORCE_ENABLE_VR: true, // Default: false.\n                // Complementary filter coefficient. 0 for accelerometer, 1 for gyro.\n                //K_FILTER: 0.98, // Default: 0.98.\n                // How far into the future to predict during fast motion.\n                //PREDICTION_TIME_S: 0.040, // Default: 0.040 (in seconds).\n                // Flag to disable touch panner. In case you have your own touch controls\n                //TOUCH_PANNER_DISABLED: true, // Default: false.\n                // Enable yaw panning only, disabling roll and pitch. This can be useful for\n                // panoramas with nothing interesting above or below.\n                //YAW_ONLY: true, // Default: false.\n                // Enable the deprecated version of the API (navigator.getVRDevices).\n                //ENABLE_DEPRECATED_API: true, // Default: false.\n                // Scales the recommended buffer size reported by WebVR, which can improve\n                // performance. Making this very small can lower the effective resolution of\n                // your scene.\n                BUFFER_SCALE: 0.5, // default: 1.0\n                // Allow VRDisplay.submitFrame to change gl bindings, which is more\n                // efficient if the application code will re-bind it's resources on the\n                // next frame anyway.\n                // Dirty bindings include: gl.FRAMEBUFFER_BINDING, gl.CURRENT_PROGRAM,\n                // gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING,\n                // and gl.TEXTURE_BINDING_2D for texture unit 0\n                // Warning: enabling this might lead to rendering issues.\n                //DIRTY_SUBMIT_FRAME_BINDINGS: true // default: false\n            };\n        },\n        getDisplayModes: function () {\n            return {\n                ORBIT: 1,\n                VR: 2,\n                FLY: 3\n            };\n        }\n    };\n})();\n","\"use strict\";\n\nvar CameraUtil = (function () {\n    return {\n        getSceneBoundingBox: function (__scene) {\n            var box = null;\n\n\n            var bBox = {\n                min: {\n                    x: Infinity,\n                    y: Infinity,\n                    z: Infinity\n                },\n                max: {\n                    x: -Infinity,\n                    y: -Infinity,\n                    z: -Infinity\n                },\n                center: {\n                    x: 0,\n                    y: 0,\n                    z: 0\n                }\n            };\n\n            __scene.traverse(function (node) {\n                if (node instanceof THREE.Mesh) {\n                    var geometry = node.geometry;\n                    geometry.computeBoundingBox();\n                    var bb = geometry.boundingBox;\n                    if (bb.min.x < bBox.min.x) {\n                        bBox.min.x = bb.min.x;\n                    }\n                    if (bb.min.y < bBox.min.y) {\n                        bBox.min.y = bb.min.y;\n                    }\n                    if (bb.min.z < bBox.min.z) {\n                        bBox.min.z = bb.min.z;\n                    }\n\n                    if (bb.max.x > bBox.max.x) {\n                        bBox.max.x = bb.max.x;\n                    }\n                    if (bb.max.y > bBox.max.y) {\n                        bBox.max.y = bb.max.y;\n                    }\n                    if (bb.max.z > bBox.max.z) {\n                        bBox.max.z = bb.max.z;\n                    }\n                }\n            });\n\n            bBox.center.x = (bBox.min.x + bBox.max.x) / 2;\n            bBox.center.y = (bBox.min.y + bBox.max.y) / 2;\n            bBox.center.z = (bBox.min.z + bBox.max.z) / 2;\n\n            return bBox;\n\n\n            // uncomment to get\n            /*__object3D.traverse(function (obj3D) {\n                var geometry = obj3D.geometry;\n                if (geometry === undefined) return;\n                geometry.computeBoundingBox();\n                if (box === null) {\n                    box = geometry.boundingBox;\n                } else {\n                    box.union(geometry.boundingBox);\n                }\n            });\n            console.log(box);\n            return box;*/\n        }\n    };\n})();\n","\"use strict\";\n\nvar ModelService = (function () {\n    return {\n        getModel: function (id) {\n            var url = '';\n            return AjaxUtil.getData(url);\n        },\n        getObjModel: function (__modelConfig, params) {\n            var rootpath = EnvConfig.protocol + EnvConfig.apiURL + __modelConfig.rootpath;\n            var objfilename = __modelConfig.objfilename;\n            return AjaxUtil.getObjFileData(rootpath, objfilename, params);\n        },\n        getObjMtlModel: function (__modelConfig, params) {\n            var rootpath = EnvConfig.protocol + EnvConfig.apiURL + __modelConfig.rootpath;\n            var objfilename = __modelConfig.objfilename;\n            var mtlfilename = __modelConfig.mtlfilename;\n            return AjaxUtil.getObjMtlFileData(rootpath, objfilename, mtlfilename, params);\n        },\n        getFbxModel: function (__modelConfig, params) {\n            var rootpath = EnvConfig.protocol + EnvConfig.apiURL + __modelConfig.rootpath;\n            return AjaxUtil.getFbxFileData(rootpath, params);\n        },\n        getColladaModel: function (__modelConfig, params) {\n            var rootpath = EnvConfig.protocol + EnvConfig.apiURL + __modelConfig.rootpath;\n            return AjaxUtil.getColladaFileData(rootpath, params);\n        }\n    };\n})();\n","\"use strict\"\n\nvar ControllerMode = (function () {\n    function ControllerMode(__scene, __renderer, __controlsContainerElementClass, __rendererWidth, __rendererHeight) {\n        this.scene = __scene;\n        this.renderer = __renderer;\n        this.controlsContainerClassNmae = __controlsContainerElementClass;\n        this.rendererWidth = __rendererWidth;\n        this.rendererHeight = __rendererHeight;\n\n        this.vrCamera = null;\n        this.orbitCamera = null;\n        this.vrEffect = null;\n        this.orbitControls = null;\n        this.vrControls = null;\n        this.vrManager = null;\n        this.displayModes = null;\n        this.currentDisplatMode = null;\n        this.skipSwitchDisplayMode = null;\n        this.vrButtonProxi = null;\n    }\n\n    ControllerMode.prototype = {\n        init: function () {\n\n            // Misc.\n            this._skipSwitchDisplayMode = false;\n            this.displayModes = ViewUtil.getDisplayModes();\n            this.currentDisplatMode = this.displayModes.ORBIT;\n\n\n            // Camera\n            this.orbitCamera = new THREE.PerspectiveCamera(45, this.rendererWidth / this.rendererHeight, 1, 20000);\n            this.vrCamera = new THREE.PerspectiveCamera(45, this.rendererWidth / this.rendererHeight, 1, 20000);\n\n            // effect \n            var WebVRConfig = ViewUtil.getWebVRSettings();\n            this.vrEffect = new THREE.VREffect(this.renderer);\n            this.vrEffect.setSize(this.rendererWidth, this.rendererHeight);\n\n            // controls, camera\n            this.orbitControls = new THREE.OrbitControls(this.orbitCamera, this.renderer.domElement);\n            this.orbitControls.enableDamping = true;\n            this.orbitControls.dampingFactor = 0.25;\n            this.orbitControls.rotateSpeed = 0.5;\n            //this.orbitControls.momentumDampingFactor = 1.8;\n\n            // smooth Zoom\n            //this.orbitControls.constraint.smoothZoom = true;\n            //this.orbitControls.constraint.zoomDampingFactor = 0.2;\n            //this.orbitControls.constraint.smoothZoomSpeed = 5.0;\n\n            this.vrControls = new THREE.VRControls(this.vrCamera);\n\n            //this.orbitCamera.position.set(100, 50, 100);\n            this.orbitControls.update();\n\n            this.vrManager = new WebVRManager(this.renderer, this.vrEffect, {\n                hideButton: true\n            });\n\n            var self = this;\n            $(window).on('vrdisplaypresentchange', function (e) {\n                if (!self.skipSwitchDisplayMode) {\n                    $(self.controlsContainerClassNmae).removeClass('hide');\n                    self.enterOrbitMode();\n                } else {\n                    self.skipSwitchDisplayMode = false;\n                }\n            });\n        },\n\n        updateOnResize: function () {\n            this.rendererWidth = window.innerWidth;\n            this.rendererHeight = window.innerHeight;\n            switch (this.currentDisplatMode) {\n\n                case this.displayModes.FLY:\n                    // update fly controls\n                    break;\n                case this.displayModes.VR:\n                    // update vr controls\n                    this.vrCamera.aspect = this.rendererWidth / this.rendererHeight;\n                    this.vrCamera.updateProjectionMatrix();\n                    this.vrEffect.setSize(this.rendererWidth, this.rendererHeight);\n                    break;\n                case this.displayModes.ORBIT:\n                    // upadate orbit controls\n                    this.orbitCamera.aspect = this.rendererWidth / this.rendererHeight;\n                    this.orbitCamera.updateProjectionMatrix();\n                    this.renderer.setSize(this.rendererWidth, this.rendererHeight);\n                    break;\n            }\n        },\n\n        render: function () {\n            //console.log(this.currentDisplatMode);\n            switch (this.currentDisplatMode) {\n\n                case this.displayModes.FLY:\n                    // update fly controls\n                    break;\n                case this.displayModes.VR:\n                    // update vr controls\n                    this.vrControls.update();\n                    this.vrManager.render(this.scene, this.vrCamera);\n                    break;\n                case this.displayModes.ORBIT:\n                    // upadate orbit controls\n                    //this.orbitControls.update();\n                    this.renderer.render(this.scene, this.orbitCamera);\n                    break;\n            }\n        },\n\n        enterVRMode: function () {\n            this.vrManager.onVRClick_();\n            this.currentDisplatMode = this.displayModes.VR;\n        },\n\n        enterOrbitMode: function () {\n            this.currentDisplatMode = this.displayModes.ORBIT;\n        },\n\n        enterFLYMode: function () {\n            this.currentDisplatMode = this.displayModes.FLY;\n        },\n\n        getCurrentMode: function () {\n            return this.currentDisplatMode;\n        },\n\n        getDisplayModes: function () {\n            return this.displayModes;\n        },\n\n        requestVRMode: function () {\n            $(this.controlsContainerClassNmae).addClass('hide');\n            this.setSkipSwitchDisplayMode(true);\n            this.enterVRMode();\n        },\n\n        setSkipSwitchDisplayMode: function (__flag) {\n            if (__flag)\n                this.skipSwitchDisplayMode = true;\n            else\n                this.skipSwitchDisplayMode = false;\n        }\n    }\n\n    return ControllerMode;\n})();\n","\"use strict\";\n\nvar SceneModel = (function () {\n    function SceneModel() {\n        this.registerEvents();\n        this.isMobileDevice = false;\n        this.modelConfig = null;\n    }\n\n    SceneModel.prototype = {\n        registerEvents: function () {\n            this.modelLoaded = new Event(this);\n        },\n        loadModel: function (__sceneConfig) {\n            var self = this;\n            var modelId = 1;\n\n            var params = {\n                'onLoad': function (object) {\n                    console.log('onload');\n                    self.modelLoaded.notify({\n                        'object': object\n                    });\n                },\n                'onError': function () {\n                    console.log('onerror');\n                },\n                'onProgress': function (xhr) {\n                    console.log('onprogress');\n                }\n            };\n\n            var modelObject = null;\n\n            if (__sceneConfig.type === 'obj')\n                ModelService.getObjModel(__sceneConfig, params);\n            else if (__sceneConfig.type === 'objmtl')\n                ModelService.getObjMtlModel(__sceneConfig, params);\n            else if (__sceneConfig.type === 'fbx')\n                ModelService.getFbxModel(__sceneConfig, params);\n            else if (__sceneConfig.type === 'collada')\n                ModelService.getColladaModel(__sceneConfig, params);\n\n            return modelObject;\n        },\n        get3DModelSettings: function () {\n            return {\n\n            };\n        }\n    }\n\n    return SceneModel;\n})();\n","\"use strict\";\n\nvar SceneView = (function () {\n    function getElements() {\n        return {\n            'mainContainer': '#app',\n            'modelContainer': '.model-container .model',\n            'controlsContainer': '.controls',\n            'animationControls': '.animation-controls',\n            'helpControl': '.control.help',\n            'settingControl': '.control.settings',\n            'vrModeControl': '.control.vr',\n            'fullScreenControl': '.control.fullscreen',\n            'animPlayerKnob': '.knob', // take translation values\n            'animPlayerBar': '.bar'\n        };\n    }\n\n    function SceneView(model) {\n        this._model = model;\n\n        this._elements = getElements();\n\n        this._scene = null;\n        this._renderer = null;\n        this._windowWidth = $(this._elements.mainContainer).width(); //window.innerWidth;\n        this._windowHeight = $(this._elements.mainContainer).height(); //window.innerHeight;\n        this._barWidth = null;\n        this._knobPosition = null;\n        this._lightAmbient = null;\n        this._lightDiretional = null;\n        this._controllerMode = null;\n\n        this._mixers = [];\n        this._actions = [];\n        this._clock = null;\n        this._playingAnimationIndex = null;\n\n        this._sceneDatum = null;\n        this._initOrbitCamPos = null;\n        this._sceneBoundingBox = null;\n        this._sceneCenter = null;\n\n        this.registerEvents();\n        this.attachModelListeners();\n\n        console.log('bar width :' + $(this._elements.animPlayerKnob).position().left);\n    }\n\n    SceneView.prototype = {\n        registerEvents: function () {\n            this.windowResized = new Event(this);\n            this.mouseMoving = new Event(this);\n        },\n        attachEvents: function () {\n            var self = this;\n\n            $(window).on('resize', function (e) {\n                self.onWindowResize();\n                self.windowResized.notify();\n            });\n\n            $(this._elements.helpControl).on('click', function (e) {\n                self.handleHelpButtonClick();\n            });\n\n            $(this._elements.settingControl).on('click', function (e) {\n                self.handleSettingsButtonClick();\n            });\n\n            $(this._elements.vrModeControl).on('click', function (e) {\n                self.handleVRButtonClick();\n            });\n\n            $(this._elements.fullScreenControl).on('click', function (e) {\n                self.handleFullScreenButtonClick();\n            });\n        },\n        attachModelListeners: function () {\n            var self = this;\n            this._model.modelLoaded.attach(function (sender, args) {\n                console.log(\"print\");\n                console.log(args);\n                self.buildSkeleton();\n                self.showModel(args);\n\n            });\n        },\n        buildSkeleton: function () {\n            this.buildView();\n            this.attachEvents();\n        },\n        buildView: function () {\n            this.initScene();\n            this.setupEnvironment();\n            this.animate();\n        },\n        initScene: function () {\n            this._scene = new THREE.Scene();\n            this._barWidth = $(this._elements.animPlayerBar).width();\n            this._knobPosition = $(this._elements.animPlayerKnob).position().left;\n            this._playingAnimationIndex = 0;\n\n            this._clock = new THREE.Clock();\n            this._renderer = new THREE.WebGLRenderer({\n                antialias: true,\n                alpha: true\n            });\n            this._renderer.setClearColor(0x000000, 0);\n            this._renderer.setPixelRatio(window.devicePixelRatio);\n            $(this._renderer.domElement).addClass('model-canvas');\n            this._renderer.setSize(this._windowWidth, this._windowHeight);\n            $(this._elements.modelContainer).append(this._renderer.domElement);\n\n\n            this._controllerMode = new ControllerMode(this._scene, this._renderer, this._elements.controlsContainer, this._windowWidth, this._windowHeight);\n            this._controllerMode.init();\n        },\n        setupEnvironment: function () {\n            this._lightAmbient = new THREE.AmbientLight(0x444444);\n            this._scene.add(this._lightAmbient);\n\n            this._lightDirectional = new THREE.DirectionalLight(0xffeedd);\n            this._lightDirectional.position.set(0, 0, 1).normalize();\n            this._scene.add(this._lightDirectional);\n        },\n        showModel: function (object) {\n            var type = this._model.modelConfig.type;\n            var geometry = null;\n            if (type === 'obj')\n                this._scene.add(object.object);\n            else if (type === 'objmtl')\n                this._scene.add(object.object);\n            else if (type === 'fbx') {\n                console.log(object.object);\n                console.log(object.object.toJSON());\n                if (object.object.animations.length > 0) {\n                    object.object.mixer = new THREE.AnimationMixer(object.object);\n                    console.log(object.object.mixer);\n\n                    this._mixers.push(object.object.mixer);\n                    var action = object.object.mixer.clipAction(object.object.animations[1]);\n\n                    console.log(action._clip);\n                    action.play();\n\n                }\n\n                this._scene.add(object.object);\n            } else if (type === 'collada') {\n                console.log(object.object);\n                var objectL = object.object.scene;\n                mixer = new THREE.AnimationMixer(objectL);\n                this._mixers.push(mixer);\n                objectL.traverse(function (child) {\n                    if (child instanceof THREE.SkinnedMesh) {\n                        var clip = THREE.AnimationClip.parseAnimation(child.geometry.animation, child.geometry.bones);\n                        mixer.clipAction(clip, child).play();\n                    }\n                });\n                this._scene.add(objectL);\n            }\n            this.postModelLoadSettings();\n        },\n        postModelLoadSettings: function () {\n            console.log(\"called...\");\n            this._sceneBoundingBox = CameraUtil.getSceneBoundingBox(this._scene);\n\n            console.log(this._sceneBoundingBox);\n\n            this._controllerMode.orbitControls.target.set(this._sceneBoundingBox.center.x, this._sceneBoundingBox.center.y, this._sceneBoundingBox.center.z);\n            //this._controlsDefault.target.set(this._sceneBoundingBox.center.x, this._sceneBoundingBox.center.y, this._sceneBoundingBox.center.z);\n            var center = new THREE.Vector3(this._sceneBoundingBox.center.x, this._sceneBoundingBox.center.y, this._sceneBoundingBox.center.z);\n            var high = new THREE.Vector3(this._sceneBoundingBox.max.x, this._sceneBoundingBox.max.y, this._sceneBoundingBox.max.z);\n            high.sub(high, center);\n            high.setLength(high.length() * 3);\n            high.addVectors(center, high);\n            //this._cameraDefault.position.set(center.x, center.y, center.z);\n            this._controllerMode.orbitCamera.position.set(high.x, high.y, high.z);\n            this._controllerMode.orbitControls.update();\n        },\n        onWindowResize: function () {\n            this._controllerMode.updateOnResize();\n        },\n        animate: function (timestamp) {\n            requestAnimationFrame(this.animate.bind(this));\n            if (this._mixers.length > 0) {\n                for (var i = 0; i < this._mixers.length; i++) {\n                    //console.log(this._mixers[i]);\n                    this._mixers[i].update(this._clock.getDelta());\n                }\n            }\n\n            this.render(timestamp);\n        },\n        render: function (timestamp) {\n            this._controllerMode.render();\n        },\n        showMenuControls: function (__animationcontroles, __help, __settings, __vrMode, __fullscreen) {\n            if (__animationcontroles == 0) {\n                $(this._elements.animationControls).addClass('hide');\n            } else {\n                $(this._elements.animationControls).removeClass('hide');\n            }\n\n\n            if (__help == 0) {\n                $(this._elements.helpControl).addClass('hide');\n            } else {\n                $(this._elements.helpControl).removeClass('hide');\n            }\n\n\n            if (__settings == 0) {\n                $(this._elements.settingControl).addClass('hide');\n            } else {\n                $(this._elements.settingControl).removeClass('hide');\n            }\n\n            if (__vrMode == 0) {\n                $(this._elements.vrModeControl).addClass('hide');\n            } else {\n                $(this._elements.vrModeControl).removeClass('hide');\n            }\n\n            if (__fullscreen == 0) {\n                $(this._elements.fullScreenControl).addClass('hide');\n            } else {\n                $(this._elements.fullScreenControl).removeClass('hide');\n            }\n        },\n\n        handleHelpButtonClick: function () {\n            //switch help overlay on or off\n            console.log(\"help button click...\");\n        },\n        handleSettingsButtonClick: function () {\n            //switch help overlay on or off\n            console.log(\"settings button click...\");\n        },\n        handleVRButtonClick: function () {\n            //switch help overlay on or off\n            console.log(\"vr button click...\");\n            this._controllerMode.requestVRMode();\n        },\n        handleFullScreenButtonClick: function () {\n            //switch help overlay on or off\n            console.log(\"fullscreen button click...\");\n            this.fullscreen();\n        },\n        fullscreen: function () {\n            console.log($(this._elements.modelContainer));\n            if ($(this._elements.modelContainer).requestFullscreen) {\n                $(this._elements.modelContainer).requestFullscreen();\n            } else if ($(this._elements.modelContainer).msRequestFullscreen) {\n                $(this._elements.modelContainer).msRequestFullscreen();\n            } else if ($(this._elements.modelContainer).mozRequestFullScreen) {\n                $(this._elements.modelContainer).mozRequestFullScreen();\n            } else if ($(this._elements.modelContainer).webkitRequestFullscreen) {\n                $(this._elements.modelContainer).webkitRequestFullscreen();\n            }\n        }\n    }\n\n    return SceneView;\n})();\n","\"use strict\";\n\nvar SceneController = (function () {\n    function SceneController(view, model) {\n        this._view = view;\n        this._model = model;\n\n        this.attachViewListeners();\n    }\n\n    SceneController.prototype = {\n        attachViewListeners: function () {\n            var self = this;\n        },\n        generateTemplate: function () {\n            var self = this;\n            this._model.isMobileDevice = this.isMobileDevice();\n\n            // check for device specifications\n            if (this._model.isMobileDevice) {\n                this._view.showMenuControls(0, 1, 0, 1, 0);\n            } else {\n                this._view.showMenuControls(0, 1, 0, 0, 1);\n            }\n\n            // load config file for model\n            var configUrl = EnvConfig.protocol + EnvConfig.apiURL + '/src/assets/data/3dmodels/objmtl/model_ID.json';\n            AjaxUtil.getData(configUrl).then(\n                function (__response) {\n                    self._model.modelConfig = __response.tempconfig;\n                    self._model.loadModel(__response.tempconfig);\n                },\n                function (__errMessage) {});\n        },\n        isMobileDevice: function () {\n            var isMobile = false; //initiate as false\n            // device detection\n            if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) ||\n                /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(navigator.userAgent.substr(0, 4))) isMobile = true;\n            return isMobile;\n        }\n\n    }\n\n    return SceneController;\n})();\n","\"use strict\";\n\nvar Event = (function(){\n    function Event(sender) {\n        this._sender = sender;\n        this._listeners = [];\n    }\n\n    Event.prototype = {\n        attach: function(listener) {\n            this._listeners.push(listener);\n        },\n        notify: function(args) {\n            var index;\n\n            for (index = 0; index < this._listeners.length; index++) {\n                this._listeners[index](this._sender, args);\n            }\n        }\n    };\n\n    return Event;\n})();","\"use strict\";\n\nvar sceneModel, sceneController, sceneView;\n\nif (!sceneModel) {\n    sceneModel = new SceneModel();\n    sceneView = new SceneView(sceneModel);\n    sceneController = new SceneController(sceneView, sceneModel);\n}\n\nsceneController.generateTemplate();\n"]}