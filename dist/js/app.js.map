{"version":3,"sources":["config.js","envConfig.js","Utils.js","AjaxUtil.js","ViewUtil.js","ModelService.js","SceneModel.js","SceneView.js","SceneController.js","Event.js","init.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["var Config = (function () {\n    var Config = {\n        urlAppName: '/pixum-model-viewer',\n        errorMsgClass: 'error-msg'\n    };\n    return Config;\n})();","var EnvConfig = (function () {\n    var env;\n\n    switch(window.location.hostname) {\n        case 'oobi.proptiger-ws.com':\n            env = 'beta';\n            break;\n        case 'oobi.proptiger.com':\n            env = 'prod';\n            break;\n        default :\n            env = 'dev';\n            break;\n\n    }\n\n    var EnvConfig = {\n        dev: {\n            env: env,\n            protocol: 'http://',\n            apiURL: 'localhost/00sandbox/pixum/model-viewer',\n            showLogs: true\n        },\n        beta: {\n            env: env,\n            protocol: window.location.protocol + '//',\n            apiURL: '',\n            showLogs: true\n        },\n        prod: {\n            env: env,\n            protocol: window.location.protocol + '//',\n            apiURL: '',\n            showLogs: false\n        }\n    };\n\n    return EnvConfig[env];\n\n})();\n","\"use strict\";\n\nvar Util = (function(){\n    return {\n        // \n    };\n})();","\"use strict\";\r\n\r\nvar AjaxUtil = (function(){\r\n    return {\r\n        getData: function (url) {\r\n            var self = this;\r\n            var ajaxObj = {\r\n                type: \"GET\",\r\n                url: url,\r\n                async: true,\r\n                dataType: \"json\",\r\n                success: function (data) {\r\n                    // register success callback in return promise\r\n                },\r\n                error: function (jqXHR, textStatus, errorThrown) {\r\n                    utils.log('read error callback for: ' + url);\r\n                    utils.log('error occured ' + errorThrown);\r\n                    self.handleAjaxErrorDefaultCallback(jqXHR, textStatus, errorThrown);\r\n                }\r\n            };\r\n\r\n            return $.ajax(ajaxObj);\r\n        },\r\n        getObjFileData: function (url,params) {\r\n            var self = this;\r\n            //var progressCallback = params.progressCallback || false;\r\n            \r\n            var onLoad = params.onLoad || function defaultOnloadCallback () {\r\n                \r\n            };\r\n            var onError = params.onError || function defaultErrorCallback () {\r\n                \r\n            };\r\n            var onProgress = params.onProgress || function (xhr) {\r\n                if ( xhr.lengthComputable ) {\r\n                    var percentComplete = xhr.loaded / xhr.total * 100;\r\n                    console.log( Math.round(percentComplete, 2) + '% downloaded' );\r\n                }\r\n            }\r\n            \r\n            var manager = new THREE.LoadingManager();\r\n            manager.onProgress = function ( item, loaded, total ) {\r\n                console.log( item, loaded, total );\r\n            };\r\n            \r\n            var loader = new THREE.OBJLoader( manager );\r\n            loader.load( url,\r\n                onLoad,\r\n                onProgress,\r\n                onError\r\n            );\r\n            \r\n            \r\n        },\r\n        makeRequest: function (url, type, data, async) {\r\n            var enableCORS = enableCORS || false;\r\n            var data  = (typeof data === 'undefined') ? {} : data;\r\n\r\n            var ajaxObj = {\r\n                type        : type,\r\n                url         : url,\r\n                async       : true,\r\n                dataType    : \"json\",\r\n                data        : JSON.stringify(data),\r\n                contentType : \"application/json\",\r\n                success     : function (data) {\r\n                    // register success callback in return promise\r\n                },\r\n                error       : function (jqXHR, textStatus, errorThrown) {\r\n                    utils.log('read error callback for: ' + url);\r\n                    utils.log('error occured ' + errorThrown);\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            return $.ajax(ajaxObj);\r\n        },\r\n        getJsonData: function (url, callback) {\r\n            var self = this;\r\n            return $.ajax({\r\n                type: 'GET',\r\n                url: url,\r\n                async: true,\r\n                jsonpCallback: callback,\r\n                contentType: \"application/json\",\r\n                dataType: \"jsonp\",\r\n                success: function (data) {\r\n                    // register success callback in return promise\r\n                },\r\n                error: function (jqXHR, textStatus, errorThrown) {\r\n                    utils.log('read json error callback for: ' + url);\r\n                    utils.log('error occured ' + errorThrown);\r\n                    self.handleAjaxErrorDefaultCallback(jqXHR, textStatus, errorThrown);\r\n                }\r\n            });\r\n        }\r\n    };\r\n})();","\"use strict\";\n\nvar ViewUtil = (function(){\n    return {\n        showModal: function(msg) {\n            alert(msg);\n        },\n        showLoader: function() {\n            var template = [];\n\n            template.push(\n                '<div id=\"loader213DSDdsdASD3dds\" style=\"position:absolute;top:0;right:0;bottom:0;left:0;\">',\n                    'Loading...',\n                '</div>'\n            );\n            template = template.join('');\n\n            $(document.body).append(template);\n        },\n        hideLoader: function() {\n            $('#loader213DSDdsdASD3dds').remove();\n        }\n    };\n})();","\"use strict\";\r\n\r\nvar ModelService = (function(){\r\n    return {\r\n        getModel: function(id) {\r\n            var url = '';\r\n            return AjaxUtil.getData(url);\r\n        },\r\n        getObjModel: function(id,params) {\r\n            var url = EnvConfig.protocol + EnvConfig.apiURL + '/src/assets/data/3dmodels/obj/male02.obj';\r\n            return AjaxUtil.getObjFileData(url, params);\r\n        }\r\n    };\r\n})();","\"use strict\";\r\n\r\nvar SceneModel = (function() {\r\n    function SceneModel() {\r\n        this.registerEvents();\r\n        \r\n    }\r\n\r\n    SceneModel.prototype = {\r\n        registerEvents : function() {\r\n            this.modelLoaded = new Event(this);\r\n        },\r\n        loadModel: function() {\r\n            var self = this;\r\n            var modelId = 1;\r\n            \r\n            var params = {\r\n                'onLoad' : function(object) {\r\n                    console.log('onload');\r\n                    self.modelLoaded.notify({'object':object});\r\n                },\r\n                'onError' : function() {\r\n                    console.log('onerror');\r\n                },\r\n                'onProgress' :  function(xhr) {\r\n                    console.log('onprogress');\r\n                }\r\n            };\r\n            \r\n            return ModelService.getObjModel(modelId, params);\r\n        }\r\n    }\r\n\r\n    return SceneModel;\r\n})();","\"use strict\";\r\n\r\nvar SceneView = (function() {\r\n    function getElements() {\r\n        return {\r\n            'mainContainer'  : '#app',\r\n            'modelContainer' : '.model-container .model',\r\n        };\r\n    }\r\n\r\n    function SceneView(model) {\r\n        this._model = model;\r\n\r\n        this._elements = getElements();\r\n        \r\n        this._scene = null;\r\n        this._camera = null;\r\n        this._renderer = null;\r\n        this._mouseX = 0;\r\n        this._mouseY = 0;\r\n        this._windowWidth = window.innerWidth;\r\n        this._windowHeight = window.innerHeight;\r\n        \r\n        this._lightAmbient = null;\r\n        this._lightDiretional = null;\r\n\r\n        this.registerEvents();\r\n        this.attachEvents();\r\n        this.attachModelListeners();\r\n    }\r\n\r\n    SceneView.prototype = {\r\n        registerEvents : function() {\r\n            this.windowResized = new Event(this);\r\n            this.mouseMoving = new Event(this);\r\n        },\r\n        attachEvents : function() {\r\n            var self = this;\r\n\r\n            $(window).on('resize', function(e) {\r\n                self.onWindowResize();\r\n                self.windowResized.notify();\r\n            });\r\n            \r\n            $(window).on('mousemove', function(e) {\r\n                self.onMouseMove(e);\r\n                self.mouseMoving.notify();\r\n            });\r\n        },\r\n        attachModelListeners: function() {\r\n            var self = this;\r\n\r\n            self._model.modelLoaded.attach(function(sender, args){\r\n                self.showModel(args);\r\n            });\r\n        },\r\n        buildSkeleton: function(data) {\r\n            // this.initControls();\r\n            this.buildView();\r\n        },\r\n        buildView: function() {\r\n            this.initScene();\r\n            this.setupEnvironment();\r\n            this.animate();\r\n        },\r\n        initScene: function() {\r\n            this._scene = new THREE.Scene();\r\n            this._camera = new THREE.PerspectiveCamera( 45, this._windowWidth / this._windowHeight, 1, 2000 );\r\n            \r\n            this._renderer = new THREE.WebGLRenderer();\r\n            this._renderer.setPixelRatio( window.devicePixelRatio );\r\n            $(this._renderer.domElement).addClass('model-canvas');\r\n            this._renderer.setSize( this._windowWidth, this._windowHeight );\r\n            $(this._elements.modelContainer).append( this._renderer.domElement );\r\n        },\r\n        setupEnvironment: function() {\r\n            this._lightAmbient = new THREE.AmbientLight( 0x444444 );\r\n            this._scene.add( this._lightAmbient );\r\n            \r\n            this._camera.position.z = 250;\r\n            \r\n            this._lightDirectional = new THREE.DirectionalLight( 0xffeedd );\r\n            this._lightDirectional.position.set( 0, 0, 1 ).normalize();\r\n            this._scene.add( this._lightDirectional );\r\n        },\r\n        showModel: function (object) {\r\n            this._scene.add(object.object);\r\n        },\r\n        onWindowResize: function() {\r\n            this._windowWidth = window.innerWidth;\r\n            this._windowHeight = window.innerHeight;\r\n            this._camera.aspect = this._windowWidth / this._windowHeight;\r\n            this._camera.updateProjectionMatrix();\r\n            this._renderer.setSize( this._windowWidth, this._windowHeight );\r\n        },\r\n        onMouseMove:function(event){\r\n            this._mouseX = ( event.clientX - this._windowWidth ) / 2;\r\n            this._mouseY = ( event.clientY - this._windowHeight ) / 2;\r\n            this.render();\r\n        },\r\n        animate: function() {\r\n\t\t\trequestAnimationFrame( this.animate.bind(this) );\r\n\t\t\tthis.render();\r\n        },\r\n        render: function() {\r\n\t\t\tthis._camera.position.x += ( this._mouseX - this._camera.position.x ) * .05;\r\n\t\t\tthis._camera.position.y += ( - this._mouseY - this._camera.position.y ) * .05;\r\n\t\t\tthis._camera.lookAt( this._scene.position );\r\n\t\t\tthis._renderer.render( this._scene, this._camera );\r\n        }\r\n    }\r\n\r\n    return SceneView;\r\n})();","\"use strict\";\r\n\r\nvar SceneController = (function() {\r\n    function SceneController(view, model) {\r\n        this._view = view;\r\n        this._model = model;\r\n\r\n        this.attachViewListeners();\r\n    }\r\n\r\n    SceneController.prototype = {\r\n        attachViewListeners : function() {\r\n            var self = this;\r\n        },\r\n        generateTemplate: function() {\r\n            var self = this;\r\n            this._model.loadModel();\r\n            self._view.buildSkeleton();\r\n        }\r\n    }\r\n\r\n    return SceneController;\r\n})();","\"use strict\";\n\nvar Event = (function(){\n    function Event(sender) {\n        this._sender = sender;\n        this._listeners = [];\n    }\n\n    Event.prototype = {\n        attach: function(listener) {\n            this._listeners.push(listener);\n        },\n        notify: function(args) {\n            var index;\n\n            for (index = 0; index < this._listeners.length; index++) {\n                this._listeners[index](this._sender, args);\n            }\n        }\n    };\n\n    return Event;\n})();","\"use strict\";\n\nvar sceneModel, sceneController, sceneView;\n\nif(!sceneModel) {\n    sceneModel = new SceneModel();\n    sceneView = new SceneView(sceneModel);\n    sceneController = new SceneController(sceneView, sceneModel);\n}\n\nsceneController.generateTemplate();"]}